name: Deploy HostGator 

on:
  push:
    branches:
      - main  # O rob么 liga quando voc锚 envia c贸digo para a 'main'

jobs:
  web-deploy:
    name:  Deploy
    runs-on: ubuntu-latest
    steps:
      # 1. Baixa o c贸digo do seu reposit贸rio
      - name:  Obter c贸digo mais recente
        uses: actions/checkout@v4

      # 2. Configura o PHP (para o Laravel)
      - name:  Configurar PHP
        uses: shivammathur/setup-php@v2
        with:
          php-version: '8.2' # Verifique a vers茫o do PHP na sua HostGator

      # 3. Instala depend锚ncias do Laravel (pasta vendor)
      - name:  Instalar Depend锚ncias PHP
        run: composer install -q --no-ansi --no-interaction --no-scripts --no-progress --prefer-dist

      # 4. Configura o Node.js (para o React/Inertia)
      - name:  Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'

      # 5. Compila o Front-end (React)
      - name:  Build do React/Inertia
        run: |
          npm ci
          npm run build

      # 6. Envia os arquivos para a HostGator via FTP
      - name:  Enviar arquivos via FTP
        uses: SamKirkland/FTP-Deploy-Action@v4.3.4
        with:
          server: ${{ secrets.FTP_SERVER }}
          username: ${{ secrets.FTP_USERNAME }}
          password: ${{ secrets.FTP_PASSWORD }}
          # Mude abaixo para a pasta onde seu site vive na HostGator
          # Geralmente 茅 ./public_html/ ou ./public_html/seusite/
          server-dir: ./public_html/ 
          
          # O que NO enviar (para economizar tempo e espa莽o)
          exclude: |
            **/.git*
            **/.git*/**
            **/node_modules/**
            **/tests/**
            .env.example
            README.md