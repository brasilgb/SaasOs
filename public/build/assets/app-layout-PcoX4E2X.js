import{f as j,j as e,r as a,b8 as F,i as y,L as Q}from"./vendor-BCaUCftH.js";import{f as D,l as $,b as E,c as T,S as G,a as O,d as V,e as Y,N as P,n as H,h as J,o as U,p as K,q as W,A as X,j as Z,k as ee}from"./app-sidebar-header-CTvG9rXW.js";import{m as se}from"./mask-Dzd4Hpc-.js";import{h as ae}from"./moment-BLMuvzoS.js";import{D as te,a as re,b as ne,c as A,d as I,f as k}from"./dialog-tQ4UDexh.js";import{B as h}from"./button-DiBFJldJ.js";import{T as ie}from"./index-D1e0gAKB.js";import{u as le}from"./app-BMrFh0Le.js";function oe(){const{company:s}=j().props;return e.jsx("footer",{className:"w-full px-3 shadow-md border-sidebar-border/80 border-t flex items-center justify-between",children:e.jsxs("div",{className:"mx-auto p-2 flex items-center justify-between px-4 w-full",children:[e.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:["©",ae().format("YYYY")," - ",s==null?void 0:s.companyname," - CNPJ: ",se(s==null?void 0:s.cnpj)]}),e.jsx("a",{href:"https://sigmaos.com.br",target:"_blank",className:"text-xs font-semibold text-gray-600",children:"SIGMAOS"})]})})}function de(){const{plans:s,qr_code:r,qr_code_base64:i,payment_id:l,error:o}=j().props,[d,c]=a.useState(!1),[_,g]=a.useState([]),[q,b]=a.useState("plans"),[m,v]=a.useState(null),[N,S]=a.useState(null),[x,C]=a.useState(null),[u,p]=a.useState(!1),[f,n]=a.useState(!1),[L,w]=a.useState(!1);a.useEffect(()=>{r&&i&&l?(v(r),S(i),C(l),b("payment"),c(!0)):o&&(alert("Ocorreu um erro ao gerar o pagamento: "+o),n(!1))},[r,i,l,o]),a.useEffect(()=>{d?(n(!0),g(s),n(!1)):setTimeout(()=>{b("plans"),g([]),v(null),S(null),C(null),p(!1),n(!1)},500)},[d,s]),a.useEffect(()=>{if(!x)return;w(!0);const t=setInterval(async()=>{try{(await F.get(route("payment.status",x))).data.paid&&(clearInterval(t),c(!1),y.visit("/"))}catch{}},5e3);return()=>{clearInterval(t),w(!1)}},[x]);const M=async t=>{n(!0),y.post(route("payment.select-plan"),{plan_id:t,source:"pay-in-advance"})},R=()=>{m&&(navigator.clipboard.writeText(m),p(!0),setTimeout(()=>p(!1),2500))},z=()=>e.jsxs("div",{children:[e.jsxs(A,{children:[e.jsx(I,{children:"Escolha um plano"}),e.jsx(k,{children:"Escolha um plano para continuar."})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 py-4",children:_.map(t=>e.jsxs("div",{className:"border rounded-lg p-4 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.name}),e.jsxs("p",{className:"text-2xl font-bold mt-2",children:["R$ ",Number(t.value).toFixed(2)]})]}),e.jsx(h,{onClick:()=>M(t.id),className:"mt-4 w-full",disabled:f,children:f?"Processando...":"Selecionar plano"})]},t.id))})]}),B=()=>e.jsxs("div",{children:[e.jsxs(A,{children:[e.jsx(I,{children:"Realize o Pagamento feito"}),e.jsx(k,{children:"Para continuar utilizando o sistema, realize o pagamento via Pix."})]}),e.jsxs("div",{className:"py-4 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4 border-2 border-dashed rounded p-2",children:N?e.jsx("img",{src:`data:image/png;base64,${N}`,className:"w-48 h-48 bg-white p-1 rounded",alt:"QR Code Pix"}):e.jsx("div",{className:"w-48 h-48 flex items-center justify-center text-sm",children:f?"Gerando QR Code...":"Erro ao gerar QR Code."})}),e.jsx(h,{onClick:R,disabled:!m||u,className:`w-full transition ${u?"bg-green-600":""}`,children:u?"Código Pix copiado!":"Copiar código Pix"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"A liberação é automática após a confirmação do pagamento."}),L&&e.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Verificando pagamento automaticamente..."})]})]});return e.jsxs(te,{open:d,onOpenChange:c,children:[e.jsx(re,{asChild:!0,children:e.jsx(h,{variant:"outline",children:"Adiantar Pagamento"})}),e.jsx(ne,{className:"sm:max-w-md",children:q==="plans"?e.jsx(z,{}):e.jsx(B,{})})]})}function ce({className:s,...r}){return e.jsx(D,{...r,className:`group-data-[collapsible=icon]:p-0 ${s||""}`,children:e.jsx($,{children:e.jsx(E,{children:e.jsx(T,{children:e.jsx(de,{})})})})})}function me(){const{company:s}=j().props;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex aspect-square size-8 items-center justify-center bg-white",children:e.jsx("img",{src:`${s!=null&&s.logo?"/storage/logos/"+(s==null?void 0:s.logo):"/images/default.png"}`,alt:"Imagem de logo"})}),e.jsx("div",{className:"ml-1 grid flex-1 text-left text-sm",children:e.jsx("span",{className:"mb-0.5 truncate leading-none font-semibold",children:(s==null?void 0:s.shortname)&&(s==null?void 0:s.shortname)})})]})}function xe(){return e.jsxs(G,{collapsible:"icon",variant:"inset",children:[e.jsx(O,{children:e.jsx(E,{children:e.jsx(T,{children:e.jsx(V,{size:"lg",asChild:!0,children:e.jsx(Q,{href:"/",prefetch:!0,children:e.jsx(me,{})})})})})}),e.jsx(Y,{children:e.jsxs(D,{children:[e.jsx(P,{items:H}),e.jsx("div",{className:"my-1",children:e.jsx(J,{items:U})}),e.jsx(P,{items:K})]})}),e.jsx(W,{children:e.jsx(ce,{className:"mt-auto"})})]})}function ue({children:s}){return e.jsxs(X,{variant:"sidebar",children:[e.jsx(xe,{}),e.jsxs(Z,{variant:"sidebar",children:[e.jsx(ee,{}),e.jsx("div",{className:"grow",children:s}),e.jsx(oe,{})]})]})}const Ce=({children:s})=>{const{appearance:r}=le();return e.jsxs(ue,{children:[s,e.jsx(ie,{theme:r})]})};export{Ce as A};
