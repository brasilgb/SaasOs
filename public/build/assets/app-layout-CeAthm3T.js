import{f,j as e,r as a,b8 as Q,i as w,b9 as R,L as V}from"./vendor-DAFaRPSW.js";import{f as I,l as Y,b as _,c as E,S as H,a as O,d as z,e as J,N as y,n as U,h as K,o as W,p as X,q as Z,A as ee,j as se,k as ae}from"./app-sidebar-header-CbWXSYeM.js";import{m as te}from"./mask-Dzd4Hpc-.js";import{h as re}from"./moment-BLMuvzoS.js";import{D as ne,a as ie,b as le,c as A,d as P,f as D}from"./dialog-DstWkYOv.js";import{B as h}from"./button-BLBZ8SJO.js";import{A as oe,b as ce,a as de}from"./alert-gjt2YxK7.js";import{T as me}from"./index-ZCiqZKNU.js";import{u as xe}from"./app-CYt1etfP.js";function ue(){const{company:s}=f().props;return e.jsx("footer",{className:"w-full px-3 shadow-md border-sidebar-border/80 border-t flex items-center justify-between",children:e.jsxs("div",{className:"mx-auto p-2 flex items-center justify-between px-4 w-full",children:[e.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:["©",re().format("YYYY")," - ",s==null?void 0:s.companyname," - CNPJ: ",te(s==null?void 0:s.cnpj)]}),e.jsx("a",{href:"https://sigmaos.com.br",target:"_blank",className:"text-xs font-semibold text-gray-600",children:"SIGMAOS"})]})})}function pe(){const{props:s}=f(),n=s.plansData||[],t=s.flash||{};console.log(t);const[i,l]=a.useState(!1),[k,c]=a.useState("plans"),[T,q]=a.useState([]),[d,j]=a.useState(null),[m,g]=a.useState(null),[b,v]=a.useState(null),[N,o]=a.useState(!1),[M,x]=a.useState(!1),[S,u]=a.useState(!1),[C,p]=a.useState(null);a.useEffect(()=>{i?(q(n),p(null)):(c("plans"),j(null),g(null),v(null),u(!1),o(!1),x(!1))},[i,n]),a.useEffect(()=>{t.qr_code&&t.qr_code_base64&&t.payment_id&&(g(t.qr_code),v(t.qr_code_base64),j(t.payment_id),c("payment"),l(!0),o(!1)),t.error&&(p(t.message||"Erro ao gerar pagamento. Tente novamente."),o(!1),c("plans"),l(!0))},[t]),a.useEffect(()=>{if(!d||!i)return;x(!0);const r=setInterval(async()=>{try{const{data:$}=await Q.get(route("payment.status",d));$.paid&&(clearInterval(r),l(!1),w.visit("/"))}catch{}},5e3);return()=>{clearInterval(r),x(!1)}},[d,i]);const F=r=>{o(!0),p(null),w.post(route("payment.select-plan"),{plan_id:r})},B=()=>{m&&(navigator.clipboard.writeText(m),u(!0),setTimeout(()=>u(!1),2500))},G=()=>e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(P,{children:"Adiantar pagamento"}),e.jsx(D,{children:"Escolha um plano para renovar sua assinatura."})]}),C&&e.jsxs(oe,{variant:"destructive",className:"mt-4",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsx(ce,{children:"Erro"}),e.jsx(de,{children:C})]}),e.jsx("div",{className:"grid gap-4 py-4",children:T.map(r=>e.jsxs("div",{className:"border rounded-lg p-4 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:r.name}),e.jsxs("p",{className:"text-2xl font-bold mt-2",children:["R$ ",Number(r.value).toFixed(2)]})]}),e.jsx(h,{className:"mt-4 w-full",disabled:N,onClick:()=>F(r.id),children:N?"Gerando pagamento...":"Selecionar plano"})]},r.id))})]}),L=()=>e.jsxs(e.Fragment,{children:[e.jsxs(A,{children:[e.jsx(P,{children:"Pagamento via Pix"}),e.jsx(D,{children:"Escaneie o QR Code ou copie o código Pix."})]}),e.jsxs("div",{className:"py-4 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4 border-2 border-dashed rounded p-2",children:b?e.jsx("img",{src:`data:image/png;base64,${b}`,className:"w-48 h-48 bg-white rounded"}):e.jsx("div",{className:"w-48 h-48 flex items-center justify-center text-sm",children:"Gerando QR Code..."})}),e.jsx(h,{onClick:B,disabled:!m,className:`w-full ${S?"bg-green-600 hover:bg-green-600":""}`,children:S?"Pix copiado!":"Copiar código Pix"}),M&&e.jsx("p",{className:"text-xs text-blue-600 mt-3",children:"Verificando pagamento automaticamente..."})]})]});return e.jsxs(ne,{open:i,onOpenChange:l,children:[e.jsx(ie,{asChild:!0,children:e.jsx(h,{variant:"outline",children:"Adiantar pagamento"})}),e.jsx(le,{className:"sm:max-w-md",children:k==="plans"?e.jsx(G,{}):e.jsx(L,{})})]})}function he({className:s,...n}){return e.jsx(I,{...n,className:`group-data-[collapsible=icon]:p-0 ${s||""}`,children:e.jsx(Y,{children:e.jsx(_,{children:e.jsx(E,{children:e.jsx(pe,{})})})})})}function fe(){const{company:s}=f().props;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex aspect-square size-8 items-center justify-center bg-white",children:e.jsx("img",{src:`${s!=null&&s.logo?"/storage/logos/"+(s==null?void 0:s.logo):"/images/default.png"}`,alt:"Imagem de logo"})}),e.jsx("div",{className:"ml-1 grid flex-1 text-left text-sm",children:e.jsx("span",{className:"mb-0.5 truncate leading-none font-semibold",children:(s==null?void 0:s.shortname)&&(s==null?void 0:s.shortname)})})]})}function je(){return e.jsxs(H,{collapsible:"icon",variant:"inset",children:[e.jsx(O,{children:e.jsx(_,{children:e.jsx(E,{children:e.jsx(z,{size:"lg",asChild:!0,children:e.jsx(V,{href:"/",prefetch:!0,children:e.jsx(fe,{})})})})})}),e.jsx(J,{children:e.jsxs(I,{children:[e.jsx(y,{items:U}),e.jsx("div",{className:"my-1",children:e.jsx(K,{items:W})}),e.jsx(y,{items:X})]})}),e.jsx(Z,{children:e.jsx(he,{className:"mt-auto"})})]})}function ge({children:s}){return e.jsxs(ee,{variant:"sidebar",children:[e.jsx(je,{}),e.jsxs(se,{variant:"sidebar",children:[e.jsx(ae,{}),e.jsx("div",{className:"grow",children:s}),e.jsx(ue,{})]})]})}const De=({children:s})=>{const{appearance:n}=xe();return e.jsxs(ge,{children:[s,e.jsx(me,{theme:n})]})};export{De as A};
