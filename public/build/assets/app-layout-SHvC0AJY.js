import{f as b,j as e,r as a,b8 as O,i as D,b9 as V,L as Y}from"./vendor-DAFaRPSW.js";import{f as _,l as H,b as q,c as F,S as J,a as U,d as K,e as W,N as k,n as X,h as Z,o as ee,p as se,q as ae,A as te,j as re,k as ne}from"./app-sidebar-header-CbWXSYeM.js";import{m as ie}from"./mask-Dzd4Hpc-.js";import{h as le}from"./moment-BLMuvzoS.js";import{D as oe,a as ce,b as de,c as E,d as T,f as M}from"./dialog-DstWkYOv.js";import{B as g}from"./button-BLBZ8SJO.js";import{A as me,b as xe,a as ue}from"./alert-gjt2YxK7.js";import{T as pe}from"./index-ZCiqZKNU.js";import{u as he}from"./app-Bsfd1exF.js";function fe(){const{company:s}=b().props;return e.jsx("footer",{className:"w-full px-3 shadow-md border-sidebar-border/80 border-t flex items-center justify-between",children:e.jsxs("div",{className:"mx-auto p-2 flex items-center justify-between px-4 w-full",children:[e.jsxs("span",{className:"text-xs text-gray-600 font-medium",children:["©",le().format("YYYY")," - ",s==null?void 0:s.companyname," - CNPJ: ",ie(s==null?void 0:s.cnpj)]}),e.jsx("a",{href:"https://sigmaos.com.br",target:"_blank",className:"text-xs font-semibold text-gray-600",children:"SIGMAOS"})]})})}function je(){const{props:s}=b(),{plansData:r}=s,{qr_code:c,qr_code_base64:d,payment_id:m,error:v,message:N}=s.flash||{},[i,l]=a.useState(!1),[L,S]=a.useState([]),[R,x]=a.useState("plans"),[u,C]=a.useState(null),[w,A]=a.useState(null),[p,P]=a.useState(null),[y,o]=a.useState(null),[h,f]=a.useState(!1),[j,n]=a.useState(!1),[z,I]=a.useState(!1);a.useEffect(()=>{i&&o(null),c&&d&&m?(C(c),A(d),P(m),x("payment"),l(!0)):v&&(o(N||"Ocorreu um erro inesperado ao processar o pagamento."),x("plans"),l(!0),n(!1))},[c,d,m,v,N]),a.useEffect(()=>{i?(n(!0),S(r),n(!1)):setTimeout(()=>{x("plans"),S([]),C(null),A(null),P(null),f(!1),n(!1),o(null)},300)},[i,r]),a.useEffect(()=>{if(!p)return;I(!0);const t=setInterval(async()=>{try{(await O.get(route("payment.status",p))).data.paid&&(clearInterval(t),l(!1),D.visit("/"))}catch{}},5e3);return()=>{clearInterval(t),I(!1)}},[p]);const B=async t=>{n(!0),o(null),D.post(route("payment.select-plan"),{plan_id:t,source:"pay-in-advance"})},Q=()=>{u&&(navigator.clipboard.writeText(u),f(!0),setTimeout(()=>f(!1),2500))},$=()=>e.jsxs("div",{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Escolha um plano"}),e.jsx(M,{children:"Escolha um plano para adiantar o pagamento."})]}),y&&e.jsxs(me,{variant:"destructive",className:"mt-4",children:[e.jsx(V,{className:"h-4 w-4"}),e.jsx(xe,{children:"Falha no Pagamento"}),e.jsx(ue,{children:y})]}),e.jsx("div",{className:"grid grid-cols-1 gap-4 py-4",children:L.map(t=>e.jsxs("div",{className:"border rounded-lg p-4 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold",children:t.name}),e.jsxs("p",{className:"text-2xl font-bold mt-2",children:["R$ ",Number(t.value).toFixed(2)]})]}),e.jsx(g,{onClick:()=>B(t.id),className:"mt-4 w-full",disabled:j,children:j?"Processando...":"Selecionar plano"})]},t.id))})]}),G=()=>e.jsxs("div",{children:[e.jsxs(E,{children:[e.jsx(T,{children:"Realize o Pagamento"}),e.jsx(M,{children:"Para continuar utilizando o sistema, realize o pagamento via Pix."})]}),e.jsxs("div",{className:"py-4 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4 border-2 border-dashed rounded p-2",children:w?e.jsx("img",{src:`data:image/png;base64,${w}`,className:"w-48 h-48 bg-white p-1 rounded",alt:"QR Code Pix"}):e.jsx("div",{className:"w-48 h-48 flex items-center justify-center text-sm",children:j?"Gerando QR Code...":"Erro ao gerar QR Code."})}),e.jsx(g,{onClick:Q,disabled:!u||h,className:`w-full transition ${h?"bg-green-600":""}`,children:h?"Código Pix copiado!":"Copiar código Pix"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-3",children:"A liberação é automática após a confirmação do pagamento."}),z&&e.jsx("p",{className:"text-xs text-blue-600 mt-2",children:"Verificando pagamento automaticamente..."})]})]});return e.jsxs(oe,{open:i,onOpenChange:l,children:[e.jsx(ce,{asChild:!0,children:e.jsx(g,{variant:"outline",children:"Adiantar Pagamento"})}),e.jsx(de,{className:"sm:max-w-md",children:R==="plans"?e.jsx($,{}):e.jsx(G,{})})]})}function ge({className:s,...r}){return e.jsx(_,{...r,className:`group-data-[collapsible=icon]:p-0 ${s||""}`,children:e.jsx(H,{children:e.jsx(q,{children:e.jsx(F,{children:e.jsx(je,{})})})})})}function be(){const{company:s}=b().props;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex aspect-square size-8 items-center justify-center bg-white",children:e.jsx("img",{src:`${s!=null&&s.logo?"/storage/logos/"+(s==null?void 0:s.logo):"/images/default.png"}`,alt:"Imagem de logo"})}),e.jsx("div",{className:"ml-1 grid flex-1 text-left text-sm",children:e.jsx("span",{className:"mb-0.5 truncate leading-none font-semibold",children:(s==null?void 0:s.shortname)&&(s==null?void 0:s.shortname)})})]})}function ve(){return e.jsxs(J,{collapsible:"icon",variant:"inset",children:[e.jsx(U,{children:e.jsx(q,{children:e.jsx(F,{children:e.jsx(K,{size:"lg",asChild:!0,children:e.jsx(Y,{href:"/",prefetch:!0,children:e.jsx(be,{})})})})})}),e.jsx(W,{children:e.jsxs(_,{children:[e.jsx(k,{items:X}),e.jsx("div",{className:"my-1",children:e.jsx(Z,{items:ee})}),e.jsx(k,{items:se})]})}),e.jsx(ae,{children:e.jsx(ge,{className:"mt-auto"})})]})}function Ne({children:s}){return e.jsxs(te,{variant:"sidebar",children:[e.jsx(ve,{}),e.jsxs(re,{variant:"sidebar",children:[e.jsx(ne,{}),e.jsx("div",{className:"grow",children:s}),e.jsx(fe,{})]})]})}const Te=({children:s})=>{const{appearance:r}=he();return e.jsxs(Ne,{children:[s,e.jsx(pe,{theme:r})]})};export{Te as A};
