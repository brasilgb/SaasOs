import{r as x,u as B,j as e,C as z,e as $}from"./vendor-DSyLU8h0.js";import{B as A}from"./button-BbUgFgUv.js";import{I as l}from"./input-D0WU2FnS.js";import{L as d}from"./label-HPS33Bwn.js";import{d as _,c as i}from"./mask-Dzd4Hpc-.js";import{S as Q}from"./switch-EMAWRXJb.js";import{a as R}from"./connectApi-CVf_agl5.js";import{I as V}from"./input-error-CaU8p-D5.js";import{s as G}from"./selectStyles-DGGAokdD.js";import{t as j}from"./app-toast-messages-BRPL5wWZ.js";import"./utils-BzNdXqU4.js";import"./index-BBFqCoUG.js";function oe({categories:g,initialData:r}){const f=!!r,[n,h]=x.useState(!1),b=g==null?void 0:g.map(s=>({value:s,label:s})),{data:t,setData:c,post:N,patch:C,progress:H,processing:S,reset:v,errors:o}=B({category:(r==null?void 0:r.category)??"",reference_number:(r==null?void 0:r.reference_number)??"",name:(r==null?void 0:r.name)??"",description:(r==null?void 0:r.description)??"",manufacturer:(r==null?void 0:r.manufacturer)??"",model_compatibility:(r==null?void 0:r.model_compatibility)??"",cost_price:(r==null?void 0:r.cost_price)??"",sale_price:(r==null?void 0:r.sale_price)??"",quantity:(r==null?void 0:r.quantity)??"",minimum_stock_level:(r==null?void 0:r.minimum_stock_level)??"",location:(r==null?void 0:r.location)??"",status:(r==null?void 0:r.status)??""}),[y,k]=x.useState(b),F=y.find(s=>s.value===(r==null?void 0:r.category))??null,[P,a]=x.useState(F),q=s=>{s.preventDefault(),f?C(route("app.parts.update",r.id),{onSuccess:()=>{j("Sucesso","Peça/Produto atualizado com sucesso")}}):N(route("app.parts.store"),{onSuccess:()=>{j("Sucesso","Peça/Produto cadastrado com sucesso"),v(),a(null)}})},O=async s=>{s.preventDefault();const p=s.target.value;try{const{data:u}=await R.get(`getparts/${p}`),{success:L,parts:m}=u;if(L&&m){const M={label:m.category,value:m.category};h(!0),a(M),c(w=>({...w,category:m.category,name:m.name,description:m.description,manufacturer:m.manufacturer,model_compatibility:m.model_compatibility,cost_price:m.cost_price,sale_price:m.sale_price,quantity:"0",minimum_stock_level:m.minimum_stock_level,location:m.location,status:m.status}))}else h(!1),v("name","description","manufacturer","model_compatibility","quantity","minimum_stock_level","location","status")}catch(u){console.error(u)}};x.useEffect(()=>{c(s=>({...s,cost_price:_(s.cost_price)})),c(s=>({...s,sale_price:_(s.sale_price)}))},[t.cost_price,t.sale_price]);const E=s=>{a(s),c("category",s?s.value:"")},I=s=>{const p={label:s,value:s};k(u=>[...u,p]),a(p),c("category",s)};return e.jsxs("form",{onSubmit:q,autoComplete:"off",className:"space-y-8",children:[e.jsxs("div",{className:"grid md:grid-cols-6 gap-4 mt-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{children:"Categoria (ou criar nova)"}),e.jsx(z,{value:P,options:y,onChange:E,onCreateOption:I,isClearable:!0,styles:G,placeholder:"Selecione ou digite a nova",className:"shadow-xs p-0 border text-gray-700 border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 h-9"}),e.jsx(V,{message:o.category})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"name",children:"Número da Peça/Produto"}),e.jsx(l,{type:"text",id:"reference_number",value:t.reference_number,onChange:s=>c("reference_number",s.target.value),onBlur:s=>O(s),maxLength:18}),o.reference_number&&e.jsx("div",{className:"text-red-500 text-sm",children:o.reference_number})]}),e.jsxs("div",{className:"grid gap-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"name",children:"Nome da Peça/Produto"}),e.jsx(l,{type:"text",id:"name",value:t.name,onChange:s=>c("name",s.target.value),readOnly:n}),o.name&&e.jsx("div",{className:"text-red-500 text-sm",children:o.name})]}),e.jsxs("div",{className:"grid gap-2 md:col-span-2",children:[e.jsx(d,{htmlFor:"description",children:"Descrição"}),e.jsx(l,{type:"text",id:"description",value:t.description,onChange:s=>c("description",s.target.value),readOnly:n}),o.description&&e.jsx("div",{className:"text-red-500 text-sm",children:o.description})]})]}),e.jsxs("div",{className:"grid gap-4 mt-4 md:grid-cols-3",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"manufacturer",children:"Fabricante"}),e.jsx(l,{type:"text",id:"manufacturer",value:t.manufacturer,onChange:s=>c("manufacturer",s.target.value),readOnly:n}),o.manufacturer&&e.jsx("div",{className:"text-red-500 text-sm",children:o.manufacturer})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"model_compatibility",children:"Modelos compatíveis"}),e.jsx(l,{type:"text",id:"model_compatibility",value:t.model_compatibility,onChange:s=>c("model_compatibility",s.target.value),readOnly:n})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"location",children:"Local de Armazenamento"}),e.jsx(l,{type:"text",id:"location",value:t.location,onChange:s=>c("location",s.target.value),readOnly:n})]})]}),e.jsxs("div",{className:"grid md:grid-cols-4 gap-4 mt-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"cost_price",children:"Preço de Custo"}),e.jsx(l,{type:"text",id:"cost_price",value:i(t.cost_price),onChange:s=>c("cost_price",s.target.value),readOnly:n,placeholder:"0"}),o.cost_price&&e.jsx("div",{className:"text-red-500 text-sm",children:o.cost_price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"sale_price",children:"Preço de Venda"}),e.jsx(l,{type:"text",id:"sale_price",value:i(t.sale_price),onChange:s=>c("sale_price",s.target.value),readOnly:n,placeholder:"0"}),o.sale_price&&e.jsx("div",{className:"text-red-500 text-sm",children:o.sale_price})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"quantity",children:"Quantidade em Estoque"}),e.jsx(l,{type:"text",id:"quantity",value:t.quantity,onChange:s=>c("quantity",s.target.value),placeholder:"0"}),o.quantity&&e.jsx("div",{className:"text-red-500 text-sm",children:o.quantity})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"minimum_stock_level",children:"Estoque Mínimo"}),e.jsx(l,{type:"text",id:"minimum_stock_level",value:t.minimum_stock_level,onChange:s=>c("minimum_stock_level",s.target.value),readOnly:n,placeholder:"0"}),o.minimum_stock_level&&e.jsx("div",{className:"text-red-500 text-sm",children:o.minimum_stock_level})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(d,{htmlFor:"status",children:"Status da Peça"}),e.jsx(Q,{id:"status",checked:t.status,onCheckedChange:s=>c("status",s)})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs(A,{type:"submit",disabled:S,children:[e.jsx($,{}),"Salvar"]})})]})}export{oe as default};
